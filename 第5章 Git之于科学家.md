# Git之于科学家




在第二章，我们讨论了如何组织一个生物信息学项目目录以及它是如何在项目中帮助我们保证工作的条理性。良好的组织性有利于任务的自动化，从而使生活变得更加轻松，同时完成更多的重复性工作。然而，项目时刻变化，或是同他人合作，因此管理文件的不同版本是一个我们必须面对的额外挑战。
<br>
你有可能已经在你的工作中使用版本控制系统。比如，你或许保存了命名为thesis-versl.docs、thesis-vers3_CD_edits.docx、analysis-vers6.R以及thesis-vers8_CD+GM+SW_edits.docx的文件。保存过往文件版本非常有用，因为它可以让我们在需要的时候恢复某个文件或部分。文件版本同时可以帮助我们区别来自合作人的不同副本。但是，*****************

合作时，项目的组织只会变得更加复杂。我们可以通过诸如Dropbox或者Google Drive去分享整个整个目录，但是我们时刻面临某个文件被删除或被毁的风险。同时，将整个生物信息学项目放在一个共享的目录也是不太可能的，比如几个G（甚至更多）的数据并不适合在网络上分享。云盘只适用于小文件的共享，却不可用于涵盖不断更新的代码和数据的庞大合作项目。

幸载，软件工程师们在蹚水之后也为我们架起了桥，版本控制系统（version contro system, VCS），它用于管理不同版本的共同编辑代码。我们之后使用的VCS叫Git，由Linus Torvalds编写。Linus编写Git的目的是管理Linux核心（亦由他编写），一个同时包含成千上万共同开发者工作的庞大代码库。如你所想，Git适用于项目的版本控制和共同开发。

然，Git的学习曲线在初期十分陡峭。我强烈建议你花时间在这一章去学习Git，但是Git（亦如其他章节）需要大量的时间和练习方可理解。通过本章，我将指出哪个功能更加的强大；此后你可以回顾这些内容，以便顺利地理解后续内容。我还建议读者能够对书中的代码加以联系，进而熟悉Git的命令。通过初期的痛苦，你登入最佳版本控制的殿堂。

##为何Git在生物信息学中如此重要
作为一个Git的长期拥护者，我向我的同事推荐了它并提供基础的教程。多数时候，我发现最难的部分是如何使科学家们相信Git值得融入他们的工作。或许你也在犹豫是否需要学习这一章，我想说的是，Git是绝对值得下功夫的技术。如果你已经百分百地相信了，你就可以醉心于下一节的内容了。

## Git让你保存项目的快照
通过版本控制系统，你在特定的时间点创建项目的快照。如果项目出现了差错，你可以回滚带上一个快照（叫做提交更改，commit）并恢复文件。拥有如此“神器”，对于快节奏的生物信息学工作而言，绝对是一大“福利”。

Git也可以帮助修复令人恼怒的程序错误（bugs）如软件回归（software regression），一段代码离奇地停止工作或给出错误的结果。比如，你在进行SNP的数据分析，发现14%的SNP落在一条染色体的编码区。这关系到你的项目，所以你将此摘录到你的论文中并commit。

两个月后，你已经忘记了此次分析的细节，但是需要回顾14%的分析过程。令你惊奇的是当你回溯到此段代码，数据已经变更为26%！如果你已经使用commit标记你的项目进度（如快照），你讲拥有整个项目的变更历史记载并锁定何处使结果发生了改变。

Git commit使你轻松地再生和回滚先前的分析版本，也可以轻松的查看每一个commit，如果它们被commit的话。甚至可以比较两个commit之间的差别。Git提供多版本的逐行代码对比，而非重复两个月前的工作去发现bug。

此外，Git是合理文档记录的重要部分，从而简化bug的修复过程。当你的代码生成结果，为该版本复现性而作的的全面记录是十分必要的。我的同事兼好友Mike Covington说：“想象你有一个铅笔记录的实验小本本，每次PCR试验后摘录下的最新的结果”。或许这有一点牵强，但是功能性上来讲没有什么本质区别。

## Git记录帮助你记录重要的代码变更
多数软甲在发展过程中会添加特性或修复bug。在科学计算中紧跟软件的发展十分重要，一个bug的修复意味着我们工作中一个正确的或一个错误的结果。Git记录代码的每一个变化，为了直观性，我以我遇到的一个情形加以说明（我觉得全球的实验室中都有发生）。

假设一个实验室中有一个聪明的生物信息学家，他写了一个脚本以截取低质量的序列区域。他将此分享给实验室中的同事。一传十，十传百。两个月后，这个生物信息学家发现代码中的一个bug在特定的时候会导致错误，他立刻给同事发出了修正版本并提醒同事防范潜在的错误。不幸的是，消息传达不及时或者同事们“稀里糊涂”地继续使用旧版本。

Git能够轻松解该问题并保证软件的及时更新。通过Git，跟进软件的更新并下载新版本变得相当容易。此外，诸如GitHub和Bitbucket的网络仓库服务使得分析和不同实验室的协同编码变得容易。

## Git保证人员离开后软件的有序、可获得
设想另一场景：一个博士后拥有了一个自己的实验室，她的不同软件工具和脚本散落在不同的路径，更有甚者，她丢失了全部的文档。四处散落的代码令同事抓狂；丢失的代码使之无法复现结果进而阻滞后续研究。

Git能够保证工作的连续性并保存所有的项目历史。在一个仓库中集中一整个项目使之保持条理。Git保持每一个commit的变化，因此全部项目的历史都是可以获得的。即使主要开发人员离开也不是一个问题。借助回滚的能力，项目的变更不在危险，新项目的的建立更加轻松。